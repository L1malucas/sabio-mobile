(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{cZkY:function(n,t,o){"use strict";o.r(t),o.d(t,"AcademicoFrequenciaPageModule",(function(){return L}));var i=o("ofXK"),e=o("3Pt+"),c=o("TEn/"),a=o("tyNb"),s=o("mrSG"),r=o("amDQ"),l=o("wd/R"),b=o("fXoL"),u=o("g8ne"),d=o("afdR"),g=o("cI5j"),m=o("QUrN");function P(n,t){if(1&n&&(b.Qb(0,"ion-col"),b.Qb(1,"h4",3),b.Cc(2),b.Pb(),b.Mb(3,"span",4),b.Pb()),2&n){const n=b.bc(2);b.zb(2),b.Fc("",n.turmaAtiva.titulo," - ",null==n.turmaAtiva.turno?null:n.turmaAtiva.turno.descricao,""),b.zb(1),b.hc("innerHTML",n.cub3Svc.normalizeString(n.turmaAtiva.nomeEscola),b.tc)}}const _=function(n){return{odd:n}};function h(n,t){if(1&n){const n=b.Rb();b.Qb(0,"ion-item",16),b.Qb(1,"ion-row"),b.Qb(2,"ion-col",10),b.Qb(3,"ion-avatar"),b.Qb(4,"ion-badge",17),b.Cc(5),b.Pb(),b.Mb(6,"img",18),b.Pb(),b.Pb(),b.Qb(7,"ion-col",19),b.Qb(8,"p",20),b.Qb(9,"b",21),b.Cc(10),b.Pb(),b.Qb(11,"small"),b.Qb(12,"b"),b.Cc(13,"Data de nascimento:"),b.Pb(),b.Cc(14),b.cc(15,"amDateFormat"),b.Pb(),b.Mb(16,"br"),b.Qb(17,"small"),b.Qb(18,"b"),b.Cc(19,"Sexo:"),b.Pb(),b.Cc(20),b.Pb(),b.Pb(),b.Pb(),b.Qb(21,"ion-col",22),b.Qb(22,"ion-button",23),b.Yb("click",(function(){return b.sc(n),b.bc().$implicit.SIT_ALUNO="AUSENTE"})),b.Mb(23,"ion-icon",24),b.Pb(),b.Pb(),b.Qb(24,"ion-col",22),b.Qb(25,"ion-button",25),b.Yb("click",(function(){return b.sc(n),b.bc().$implicit.SIT_ALUNO="PRESENTE"})),b.Mb(26,"ion-icon",26),b.Pb(),b.Pb(),b.Pb(),b.Pb()}if(2&n){const n=b.bc(),t=n.index,o=n.$implicit,i=b.bc(4);b.hc("ngClass",b.mc(11,_,t%2==0)),b.zb(5),b.Dc(o.id),b.zb(1),b.jc("src","assets/img/avatar-",2==o.sexo?"menina":"menino",".jpg",b.uc),b.zb(4),b.Dc(i.cub3Svc.normalizeString(o.nome)),b.zb(4),b.Ec(" ",b.ec(15,8,o.dataNascimento,"DD/MM/YYYY"),""),b.zb(6),b.Ec(" ",1==o.sexo?"Masculino":"Feminino",""),b.zb(2),b.ic("fill","AUSENTE"!=o.SIT_ALUNO?"outline":"solid"),b.zb(3),b.ic("fill","PRESENTE"!=o.SIT_ALUNO?"outline":"solid")}}function f(n,t){if(1&n&&(b.Ob(0),b.Ac(1,h,27,13,"ion-item",15),b.Nb()),2&n){const n=t.$implicit;b.zb(1),b.hc("ngIf",n)}}function O(n,t){if(1&n&&(b.Ob(0),b.Qb(1,"ion-list",13),b.Ac(2,f,2,1,"ng-container",14),b.Pb(),b.Nb()),2&n){const n=b.bc(3);b.zb(2),b.hc("ngForOf",n.dados.alunos)}}function p(n,t){1&n&&b.Mb(0,"ion-spinner",27)}function M(n,t){if(1&n&&(b.Qb(0,"ion-card"),b.Qb(1,"ion-card-header"),b.Mb(2,"ion-icon",5),b.Cc(3," Alunos da turma "),b.Pb(),b.Qb(4,"ion-card-content"),b.Qb(5,"ion-list",6),b.Qb(6,"ion-item",7),b.Qb(7,"ion-row",8),b.Qb(8,"ion-col",9),b.Qb(9,"h6"),b.Qb(10,"b"),b.Cc(11,"Aluno"),b.Pb(),b.Pb(),b.Pb(),b.Qb(12,"ion-col",10),b.Qb(13,"h6",11),b.Qb(14,"b"),b.Cc(15,"Ausente"),b.Pb(),b.Pb(),b.Pb(),b.Qb(16,"ion-col",10),b.Qb(17,"h6"),b.Qb(18,"b"),b.Cc(19,"Presente"),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Ac(20,O,3,1,"ng-container",1),b.Ac(21,p,1,0,"ion-spinner",12),b.Pb(),b.Pb(),b.Pb()),2&n){const n=b.bc(2);b.zb(20),b.hc("ngIf",null!=n.dados&&!n.carregando),b.zb(1),b.hc("ngIf",null!=n.carregando&&1==n.carregando)}}function C(n,t){if(1&n){const n=b.Rb();b.Qb(0,"ion-slide"),b.Qb(1,"ion-avatar"),b.Mb(2,"img",18),b.Pb(),b.Qb(3,"h2"),b.Qb(4,"b"),b.Cc(5),b.Pb(),b.Mb(6,"br"),b.Cc(7),b.Pb(),b.Mb(8,"br"),b.Qb(9,"small"),b.Qb(10,"b"),b.Cc(11,"Data de nascimento:"),b.Pb(),b.Mb(12,"br"),b.Cc(13),b.cc(14,"amDateFormat"),b.Pb(),b.Mb(15,"br"),b.Qb(16,"small"),b.Qb(17,"b"),b.Cc(18,"Sexo:"),b.Pb(),b.Mb(19,"br"),b.Cc(20),b.Pb(),b.Qb(21,"ion-row"),b.Qb(22,"ion-col"),b.Qb(23,"ion-button",28),b.Yb("click",(function(){b.sc(n);const o=t.$implicit,i=t.index;return b.bc(3).setFreq(o,"AUSENTE",i)})),b.Mb(24,"ion-icon",29),b.Qb(25,"span",30),b.Cc(26,"Ausente"),b.Pb(),b.Pb(),b.Pb(),b.Qb(27,"ion-col"),b.Qb(28,"ion-button",31),b.Yb("click",(function(){b.sc(n);const o=t.$implicit,i=t.index;return b.bc(3).setFreq(o,"PRESENTE",i)})),b.Mb(29,"ion-icon",32),b.Qb(30,"span",30),b.Cc(31,"Presente"),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb()}if(2&n){const n=t.$implicit,o=b.bc(3);b.zb(2),b.jc("src","assets/img/avatar-",2==n.sexo?"menina":"menino",".jpg",b.uc),b.zb(3),b.Dc(n.id),b.zb(2),b.Ec(" ",o.cub3Svc.normalizeString(n.nome),""),b.zb(6),b.Ec(" ",b.ec(14,7,n.dataNascimento,"DD/MM/YYYY"),""),b.zb(7),b.Ec(" ",1==n.sexo?"Masculino":"Feminino",""),b.zb(3),b.ic("fill","AUSENTE"!=n.SIT_ALUNO?"outline":"solid"),b.zb(5),b.ic("fill","PRESENTE"!=n.SIT_ALUNO?"outline":"solid")}}function A(n,t){if(1&n&&(b.Qb(0,"ion-slides"),b.Ac(1,C,32,10,"ion-slide",14),b.Pb()),2&n){const n=b.bc(2);b.zb(1),b.hc("ngForOf",n.dados.alunos)}}function I(n,t){if(1&n&&(b.Qb(0,"ion-content"),b.Qb(1,"ion-row",2),b.Ac(2,P,4,3,"ion-col",1),b.Pb(),b.Ac(3,M,22,2,"ion-card",1),b.Ac(4,A,2,1,"ion-slides",1),b.Pb()),2&n){const n=b.bc();b.zb(2),b.hc("ngIf",n.turmaAtiva),b.zb(1),b.hc("ngIf",!n.carregando&&null!=n.dados.alunos&&n.dados.alunos.length>0&&"Lista"==n.modoExibicao),b.zb(1),b.hc("ngIf",!n.carregando&&null!=n.dados.alunos&&n.dados.alunos.length>0&&"Slides"==n.modoExibicao)}}function v(n,t){if(1&n&&(b.Qb(0,"ion-col"),b.Qb(1,"b",35),b.Cc(2),b.Pb(),b.Cc(3," alunos na turma "),b.Pb()),2&n){const n=b.bc(2);b.zb(2),b.Dc(n.dados.alunos.length)}}function E(n,t){if(1&n){const n=b.Rb();b.Qb(0,"ion-button",36),b.Yb("click",(function(){return b.sc(n),b.bc(2).finalizarChamada()})),b.Cc(1,"Finalizar chamada"),b.Pb()}}function S(n,t){if(1&n){const n=b.Rb();b.Qb(0,"ion-footer"),b.Qb(1,"ion-row"),b.Ac(2,v,4,1,"ion-col",1),b.Qb(3,"ion-col"),b.Ac(4,E,2,0,"ion-button",33),b.Qb(5,"ion-button",34),b.Yb("click",(function(){return b.sc(n),b.bc().revisarChamada()})),b.Cc(6,"Revisar chamada"),b.Pb(),b.Pb(),b.Pb(),b.Pb()}if(2&n){const n=b.bc();b.zb(2),b.hc("ngIf","Slides"==n.modoExibicao),b.zb(2),b.hc("ngIf","Lista"==n.modoExibicao)}}const U=[{path:"",component:(()=>{class n{constructor(n,t,o,i,e,c,a){this.cub3Db=n,this.navCtrl=t,this.cub3Svc=o,this.location=i,this.route=e,this.router=c,this.alertCtrl=a,this.turma={aulas:[],IDF_TURMA:null},this.turmaAtiva={},this.dados={},this.data={MOB_REGISTRO_AULA:[]},this.carregando=!0,this.modoExibicao="Slides"}ngOnInit(){this.route.url.subscribe(()=>{const n=this.route.snapshot.params.id,t=this.route.snapshot.params.idAula;n&&"undefined"!==n?(this.turma.IDF_TURMA=n,this.turma.IDF_AULA=t,this.init()):this.location.back()})}init(){return Object(s.a)(this,void 0,void 0,(function*(){this.data=r.a.getItem("data"),this.carregando=!0;const n=yield this.cub3Svc.getTurmas(),t=yield this.cub3Db.getStorage("MOB_REGISTRO_AULA");this.turmaAtiva=n.find(n=>n.id==this.turma.IDF_TURMA),this.aula=t.find(n=>n.IDF_AULA==this.turma.IDF_AULA),console.log(this.turma.aulas),this.carregando=!1,this.getAlunos()}))}getAlunos(){return Object(s.a)(this,void 0,void 0,(function*(){console.log("Obtendo alunos",this.turma),this.carregando=!0;const n=yield this.cub3Db.getStorage("MOV_REGISTRO_FREQUENCIA"),t=yield this.cub3Db.getStorage("MOB_REGISTRO_AULA"),o=t.find(n=>parseInt(n.IDF_AULA)===parseInt(this.turma.IDF_AULA));this.dados.alunos=this.turmaAtiva.alunos.map(i=>{const e=n.find(n=>parseInt(n.IDF_ALUNO)===parseInt(i.id)&&parseInt(n.IDF_AULA)===parseInt(this.turma.IDF_AULA)&&"PRESENTE"!==n.SIT_ALUNO);if(console.log("Aluno verificado",e),e)i.SIT_ALUNO=e.SIT_ALUNO;else if(this.aula&&this.aula.IDF_ALUNO_AUSENTES&&this.aula.IDF_ALUNO_AUSENTES.includes(""+i.id))i.SIT_ALUNO="AUSENTE";else{let n=t.find(n=>l.utc(n.DAT_AULA).format("YYYY-MM-DD")===l.utc(o.DAT_AULA).format("YYYY-MM-DD")&&parseInt(n.IDF_TURMA)===parseInt(o.IDF_TURMA));console.log("Buscando aula alternativa",[t,o]),i.SIT_ALUNO=n&&n.IDF_ALUNO_AUSENTES&&n.IDF_ALUNO_AUSENTES.includes(""+i.id)||n&&n.frequencias&&n.frequencias.some(n=>parseInt(n.IDF_ALUNO)===parseInt(i.id)&&"PRESENTE"!==n.SIT_ALUNO)?"AUSENTE":"PRESENTE"}return i}),console.log(this.dados.alunos),console.log("Aula",this.aula),this.carregando=!1}))}revisarChamada(){this.modoExibicao="Slides"===this.modoExibicao?"Lista":"Slides"}setFreq(n,t,o){this.dados.alunos[o].SIT_ALUNO=t,o<this.dados.alunos.length-1?this.slides.slideTo(o+1,500):this.revisarChamada()}finalizarChamada(){return Object(s.a)(this,void 0,void 0,(function*(){const n=yield this.cub3Svc.carregar(1);let t=0,o=[];for(let i=0;i<this.dados.alunos.length;i++){const n=this.dados.alunos[i];if(n&&null!=n.SIT_ALUNO&&null!=n.SIT_ALUNO){t++;let i={IDF_FREQUENCIA:Math.floor(1e3*Math.random())+1,IDF_AULA:this.turma.IDF_AULA,IDF_ALUNO:n.id,SIT_ALUNO:n.SIT_ALUNO};o.push(i)}}if(t===this.dados.alunos.length){let t=yield this.cub3Db.getStorage("MOV_REGISTRO_FREQUENCIA"),i=t.filter(n=>parseInt(n.IDF_AULA)===parseInt(this.turma.IDF_AULA)&&o.some(t=>parseInt(t.IDF_ALUNO)===parseInt(n.IDF_ALUNO)));console.log("Frequencias eliminadas",i),t=t.filter(n=>!(parseInt(n.IDF_AULA)===parseInt(this.turma.IDF_AULA)&&o.some(t=>parseInt(t.IDF_ALUNO)===parseInt(n.IDF_ALUNO)))),t=[...t,...o],yield this.cub3Db.setStorage("MOV_REGISTRO_FREQUENCIA",t),o.length==o.length&&this.cub3Svc.sincronizar("MOB_REGISTRO_AULA").then(()=>{n.dismiss(),this.cub3Svc.alerta("Registro de frequ\xeancia","Registro sincronizado com sucesso!"),this.navCtrl.pop()},t=>{console.log("Erro freq",t),n.dismiss(),this.cub3Svc.alerta("Registro de frequ\xeancia","Registro atualizado com sucesso!"),this.navCtrl.pop()})}else n.dismiss(),this.cub3Svc.alerta("Frequ\xeancia incompleta","Por favor, verifique se todos os alunos foram marcados com presen\xe7a ou falta.")}))}}return n.\u0275fac=function(t){return new(t||n)(b.Lb(u.a),b.Lb(c.Fb),b.Lb(d.a),b.Lb(i.n),b.Lb(a.a),b.Lb(a.g),b.Lb(c.b))},n.\u0275cmp=b.Fb({type:n,selectors:[["app-academico-frequencia"]],viewQuery:function(n,t){var o;1&n&&b.Gc(c.ob,!0),2&n&&b.qc(o=b.Zb())&&(t.slides=o.first)},decls:3,vars:6,consts:[[3,"titulo","voltar","icone","exibirAvatar"],[4,"ngIf"],[2,"padding","0 20px"],[1,"header4",2,"margin","0","padding","0","font-weight","bold"],[3,"innerHTML"],["name","ios-people-outline","item-start",""],[1,"alunos-lista"],["lines","none"],[1,"table-header"],["size","8"],["size","2"],[2,"width","100%","text-align","right"],["name","crescent","class","carregando","color","primary",4,"ngIf"],[1,"alunos-lista","listOpcoes"],[4,"ngFor","ngForOf"],["lines","none",3,"ngClass",4,"ngIf"],["lines","none",3,"ngClass"],["color","secondary",2,"float","right","font-size",".8em","position","absolute","right","0","bottom","2"],[3,"src"],["size","6"],[1,"turmaDias",2,"position","relative"],[2,"color","black","white-space","nowrap","text-overflow","ellipsis","overflow","hidden","max-width","100%","display","block"],["size","2",1,"flex"],["size","small","color","danger",1,"btnFrequencia","btnAusente",3,"fill","click"],["name","close-circle-outline",1,"mr-0"],["size","small","color","primary",1,"btnFrequencia","btnPresente",3,"fill","click"],["name","checkmark-circle-outline",1,"mr-0"],["name","crescent","color","primary",1,"carregando"],["ion-button","","color","danger",1,"btnFrequencia","btnAusente",3,"fill","click"],["name","close-circle-outline"],[2,"font-size",".8em !important"],["ion-button","","color","primary",1,"btnFrequencia","btnPresente",3,"fill","click"],["name","checkmark-circle-outline"],["color","primary","style","float:right;",3,"click",4,"ngIf"],["color","danger",2,"float","right",3,"click"],["color","secondary"],["color","primary",2,"float","right",3,"click"]],template:function(n,t){1&n&&(b.Mb(0,"cub3-header",0),b.Ac(1,I,5,3,"ion-content",1),b.Ac(2,S,7,2,"ion-footer",1)),2&n&&(b.hc("titulo","Registro de <br /> <b>frequ\xeancia</b>")("voltar",!0)("icone","bookmarks-outline")("exibirAvatar",!1),b.zb(1),b.hc("ngIf",t.turmaAtiva),b.zb(1),b.hc("ngIf",null!=t.dados&&null!=t.dados.alunos))},directives:[g.a,i.t,c.u,c.gb,c.t,c.m,c.o,c.C,c.n,c.O,c.H,i.s,i.q,c.f,c.j,c.k,c.pb,c.ob,c.nb,c.z],pipes:[m.c],styles:[".carregando[_ngcontent-%COMP%]{margin:40px auto}.alunos-lista[_ngcontent-%COMP%], ion-card-content[_ngcontent-%COMP%]{padding:0;margin:0}ion-card[_ngcontent-%COMP%]{width:100%!important;margin:0!important}ion-card[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:0!important}.table-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:12px!important}.alunos-lista[_ngcontent-%COMP%]{margin:0!important;width:100%!important}.alunos-lista[_ngcontent-%COMP%]   .btnFrequencia[_ngcontent-%COMP%]{max-width:100%;--padding-start:10px!important;--padding-end:10px!important;margin:auto;display:block;position:relative}.alunos-lista[_ngcontent-%COMP%]   .item.odd[_ngcontent-%COMP%]{background:#eee}.alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{height:80px;line-height:50px;vertical-align:middle;justify-content:center;border-bottom:1px solid #ccc}.alunos-lista[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active{background:var(--ion-color-primary)}.alunos-lista[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active   .label[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active   h2[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active   ion-icon[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active   p[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:active   span[_ngcontent-%COMP%]{color:#fff!important}.alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{border:2px solid var(--ion-color-secondary);background:#ddd;text-align:center;font-weight:700;opacity:1!important;width:100%;margin:0}.alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .aluno[_ngcontent-%COMP%], .alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}.alunos-lista[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .aluno[_ngcontent-%COMP%]{font-size:1rem;max-width:100%;display:block}.text-center[_ngcontent-%COMP%]{text-align:center!important;justify-content:center}.btnFrequencia[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{padding-right:10px;font-size:3rem}.btnFrequencia.ion-color-primary[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.btnFrequencia.ion-color-primary.button-solid[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.btnAusente[_ngcontent-%COMP%]{float:right}.btnAusente.ion-color-danger[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.btnAusente.ion-color-danger.button-solid[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.btnPresente[_ngcontent-%COMP%]{float:left}ion-content[_ngcontent-%COMP%]{height:calc(100vh - 50px)}ion-footer[_ngcontent-%COMP%]{background:#eee;border-top:2px solid #ddd}ion-footer[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0;display:flex;justify-content:center;align-items:center}ion-footer[_ngcontent-%COMP%]   .btn-finalizar[_ngcontent-%COMP%]{font-size:1.2rem;top:-14px}.avatar[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;margin:0;-o-object-fit:cover;object-fit:cover;-o-object-position:center right;object-position:center right}ion-slides[_ngcontent-%COMP%]{margin:20px;background:#fafafa;padding:0;border-radius:20px}ion-slides[_ngcontent-%COMP%], ion-slides[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]{align-items:center;justify-content:center}ion-slides[_ngcontent-%COMP%]   ion-slide[_ngcontent-%COMP%]{width:100%;padding:20px;display:flex;flex-direction:column}"]}),n})()}];let Q=(()=>{class n{}return n.\u0275mod=b.Jb({type:n}),n.\u0275inj=b.Ib({factory:function(t){return new(t||n)},imports:[[a.k.forChild(U)],a.k]}),n})();var F=o("HBpY");let L=(()=>{class n{}return n.\u0275mod=b.Jb({type:n}),n.\u0275inj=b.Ib({factory:function(t){return new(t||n)},imports:[[i.c,e.e,m.l,c.Bb,F.a,Q]]}),n})()}}]);