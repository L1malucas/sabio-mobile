(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{CIlZ:function(o,i,t){"use strict";t.r(i),t.d(i,"MeusDadosRegistroJornadaNovoPageModule",(function(){return M}));var n=t("ofXK"),s=t("3Pt+"),e=t("TEn/"),a=t("tyNb"),r=t("mrSG"),c=t("amDQ"),l=t("wd/R"),b=t("fXoL"),d=t("g8ne"),g=t("Bfh1"),h=t("WOgW"),u=t("afdR"),O=t("cI5j"),P=t("QUrN");const C=function(o,i){return{entrada:o,saida:i}};function m(o,i){if(1&o&&(b.Qb(0,"div",5),b.Qb(1,"span",6),b.Cc(2,"\xdaltimo registro de "),b.Qb(3,"span",7),b.Cc(4),b.Pb(),b.Cc(5," no dia "),b.Qb(6,"b"),b.Cc(7),b.cc(8,"amDateFormat"),b.Pb(),b.Cc(9," \xe0s "),b.Qb(10,"b"),b.Cc(11),b.cc(12,"amDateFormat"),b.Pb(),b.Pb(),b.Pb()),2&o){const o=b.bc();b.zb(3),b.hc("ngClass",b.nc(10,C,"ENTRADA"==o.ultimoRegistro.TIP_REGISTRO,"SAIDA"==o.ultimoRegistro.TIP_REGISTRO)),b.zb(1),b.Dc(o.ultimoRegistro.TIP_REGISTRO),b.zb(3),b.Dc(b.ec(8,4,o.ultimoRegistro.DAT_REGISTRO,"L")),b.zb(4),b.Dc(b.ec(12,7,o.ultimoRegistro.DAT_REGISTRO,"HH:mm"))}}function _(o,i){if(1&o){const o=b.Rb();b.Ob(0),b.Qb(1,"ion-list",8),b.Qb(2,"ion-item",9),b.Yb("click",(function(){return b.sc(o),b.bc().registrar("E")})),b.Qb(3,"ion-label"),b.Qb(4,"b"),b.Cc(5,"Entrada"),b.Pb(),b.Mb(6,"br"),b.Qb(7,"small"),b.Cc(8,"Registrar entrada."),b.Pb(),b.Pb(),b.Mb(9,"ion-icon",10),b.Mb(10,"ion-ripple-effect"),b.Pb(),b.Qb(11,"ion-item",11),b.Yb("click",(function(){return b.sc(o),b.bc().registrar("S")})),b.Qb(12,"ion-label"),b.Qb(13,"b"),b.Cc(14,"Sa\xedda"),b.Pb(),b.Mb(15,"br"),b.Qb(16,"small"),b.Cc(17,"Registrar sa\xedda."),b.Pb(),b.Pb(),b.Mb(18,"ion-icon",10),b.Mb(19,"ion-ripple-effect"),b.Pb(),b.Pb(),b.Nb()}}function f(o,i){if(1&o&&(b.Ob(0),b.Qb(1,"ion-list",8),b.Qb(2,"ion-item"),b.Qb(3,"ion-label"),b.Cc(4,"Confirma\xe7\xe3o de registro de jornada"),b.Pb(),b.Pb(),b.Qb(5,"ion-row"),b.Qb(6,"ion-col",12),b.Qb(7,"ion-label"),b.Cc(8," Nome "),b.Pb(),b.Pb(),b.Qb(9,"ion-col"),b.Cc(10),b.Pb(),b.Pb(),b.Qb(11,"ion-row"),b.Qb(12,"ion-col",12),b.Qb(13,"ion-label"),b.Cc(14," Tipo "),b.Pb(),b.Pb(),b.Qb(15,"ion-col"),b.Cc(16),b.Pb(),b.Pb(),b.Qb(17,"ion-row"),b.Qb(18,"ion-col",12),b.Qb(19,"ion-label"),b.Cc(20," Ano Letivo "),b.Pb(),b.Pb(),b.Qb(21,"ion-col"),b.Cc(22),b.Pb(),b.Pb(),b.Qb(23,"ion-row"),b.Qb(24,"ion-col",12),b.Qb(25,"ion-label"),b.Cc(26," Data "),b.Pb(),b.Pb(),b.Qb(27,"ion-col"),b.Cc(28),b.cc(29,"amDateFormat"),b.Pb(),b.Pb(),b.Qb(30,"ion-row"),b.Qb(31,"ion-col",12),b.Qb(32,"ion-label"),b.Cc(33," Hora "),b.Pb(),b.Pb(),b.Qb(34,"ion-col"),b.Cc(35),b.cc(36,"amDateFormat"),b.Pb(),b.Pb(),b.Pb(),b.Nb()),2&o){const o=b.bc();b.zb(10),b.Ec(" ",o.usuario.nome," "),b.zb(5),b.Cb("tipo-",o.tipoRegistro,""),b.zb(1),b.Ec(" ","E"==o.tipoRegistro?"Entrada":"Sa\xedda"," "),b.zb(6),b.Ec(" ",o.usuario.ano_letivo," "),b.zb(6),b.Ec(" ",b.ec(29,8,o.dataAtual,"DD/MM/YYYY")," "),b.zb(7),b.Ec(" ",b.ec(36,11,o.dataAtual,"HH:mm")," ")}}function p(o,i){if(1&o){const o=b.Rb();b.Qb(0,"ion-toolbar",null,13),b.Qb(2,"ion-button",14),b.Yb("click",(function(){return b.sc(o),b.bc().registrarPronto()})),b.Cc(3," Confirmar "),b.Pb(),b.Pb()}}const S=[{path:"",component:(()=>{class o{constructor(o,i,t,n,s,e){this.cub3Db=o,this.geolocation=i,this.androidPermissions=t,this.platform=n,this.router=s,this.cub3Svc=e,this.novoRegistro=!1,this.tipoRegistro="",this.usuario=c.a.getAccount(),this.dataAtual=l(new Date),this.data={MOB_ESCOLA:[]},this.localizacao={lat:0,lng:0},this.registro={},this.watchCoords=!1}ngOnInit(){}ionViewWillEnter(){this.init()}ionViewWillLeave(){this.watchCoords=!1}init(){return Object(r.a)(this,void 0,void 0,(function*(){this.usuario=c.a.getAccount(),this.getRegistros(),this.getEscolas(),this.novoRegistro=!1,this.watchCoords=!0,this.platform.is("android")&&(this.androidPermissions.checkPermission(this.androidPermissions.PERMISSION.ACCESS_FINE_LOCATION).then(o=>{o.hasPermission?(this.getLocal(),this.geolocation.watchPosition().subscribe(o=>{this.watchCoords&&null!=o&&o.coords&&(this.localizacao.lat=o.coords.latitude,this.localizacao.lng=o.coords.longitude)})):window.location.reload(),console.log("Has permission?",o.hasPermission)},o=>this.androidPermissions.requestPermission(this.androidPermissions.PERMISSION.ACCESS_FINE_LOCATION)),this.androidPermissions.checkPermission(this.androidPermissions.PERMISSION.ACCESS_COARSE_LOCATION).then(o=>console.log("Has permission?",o.hasPermission),o=>this.androidPermissions.requestPermission(this.androidPermissions.PERMISSION.ACCESS_COARSE_LOCATION)),this.androidPermissions.checkPermission(this.androidPermissions.PERMISSION.ACCESS_LOCATION_EXTRA_COMMANDS).then(o=>console.log("Has permission?",o.hasPermission),o=>this.androidPermissions.requestPermission(this.androidPermissions.PERMISSION.ACCESS_LOCATION_EXTRA_COMMANDS)))}))}getLocal(){return new Promise((o,i)=>{try{this.geolocation.getCurrentPosition().then(t=>{null!=t&&t.coords?(this.localizacao.lat=t.coords.latitude,this.localizacao.lng=t.coords.longitude,o(t.coords)):i(t)}).catch(o=>{i(o)})}catch(t){console.log(t),i(t)}})}registrar(o){this.tipoRegistro=o,this.dataAtual=l(new Date),this.novoRegistro=!0}getRegistros(){this.cub3Db.query("SELECT * FROM MOB_PROF_FRQ ORDER BY IDF_FREQUENCIA DESC LIMIT 0,1 ").then(o=>{null!=o&&(this.ultimoRegistro=o.rows.item(0))})}registrarPronto(){return Object(r.a)(this,void 0,void 0,(function*(){const o=yield this.cub3Svc.carregar(1);(!this.data.MOB_ESCOLA||this.data.MOB_ESCOLA&&0==this.data.MOB_ESCOLA.length)&&(o.dismiss(),this.cub3Svc.alerta("Ops!","N\xe3o foi poss\xedvel localizar as informa\xe7\xf5es da escola. Realize a sincroniza\xe7\xe3o novamente."));try{this.getLocal().then(i=>{this.registro={IDF_FREQUENCIA:l().unix(),IDF_PROFISSIONAL:this.usuario.id,ANO_LETIVO:this.usuario.ano_letivo,IDF_ESCOLA:this.data.MOB_ESCOLA[0].IDF_ESCOLA,TIP_REGISTRO:"E"==this.tipoRegistro?"ENTRADA":"SAIDA",DAT_REGISTRO:this.dataAtual,LOC_LATITUDE:i.latitude,LOC_LONGITUDE:i.longitude},this.registro.LOC_LATITUDE=i.latitude,this.registro.LOC_LONGITUDE=i.longitude;let t=Object.assign({},this.registro);t.DAT_REGISTRO=t.DAT_REGISTRO.format("YYYY-MM-DD HH:mm:ss");try{this.cub3Db.add("MOB_PROF_FRQ",t),console.log("Jornada",t),this.cub3Svc.alerta("Registro de jornada","Registro inserido com sucesso!"),this.router.navigate(["/app/home/academico"])}catch(n){}finally{o.dismiss()}},()=>{o.dismiss(),this.cub3Svc.alerta("Ops!","N\xe3o foi poss\xedvel registrar a frequ\xeancia. Por favor, verifique se a localiza\xe7\xe3o est\xe1 habilitada no dispositivo ou se as devidas permiss\xf5es foram concedidas.")})}catch(i){o.dismiss(),this.cub3Svc.alerta("Ops!","N\xe3o foi poss\xedvel registrar a frequ\xeancia. Por favor, verifique se a localiza\xe7\xe3o est\xe1 habilitada no dispositivo, se os dados est\xe3o sincronizados corretamente ou se as devidas permiss\xf5es foram concedidas.")}}))}getEscolas(){return Object(r.a)(this,void 0,void 0,(function*(){let o=yield this.cub3Svc.carregar(1);this.cub3Db.query("SELECT * FROM MOB_ESCOLA GROUP BY IDF_ESCOLA").then(i=>{if(null!=i){for(var t=0;t<i.rows.length;t++)this.data.MOB_ESCOLA.push(i.rows.item(t)),console.log(this.data.MOB_ESCOLA);this.data.MOB_ESCOLA[0]&&(this.registro.IDF_ESCOLA=this.data.MOB_ESCOLA[0].IDF_ESCOLA)}o.dismiss()},()=>{o.dismiss()})}))}}return o.\u0275fac=function(i){return new(i||o)(b.Lb(d.a),b.Lb(g.a),b.Lb(h.a),b.Lb(e.Ib),b.Lb(a.g),b.Lb(u.a))},o.\u0275cmp=b.Fb({type:o,selectors:[["app-meus-dados-registro-jornada-novo"]],decls:8,vars:9,consts:[[3,"titulo","voltar","icone","exibirAvatar"],["id","alerta",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf"],["id","alerta"],[2,"text-align","center","display","block","width","100%"],[3,"ngClass"],[1,"listOpcoes"],[1,"ion-activatable","ripple-parent",3,"click"],["name","exit-outline","slot","end"],["lines","none",1,"saida",3,"click"],["size","3"],["footer",""],["color","primary",3,"click"]],template:function(o,i){1&o&&(b.Mb(0,"cub3-header",0),b.Qb(1,"ion-content"),b.Ac(2,m,13,13,"div",1),b.Ob(3,2),b.Ac(4,_,20,0,"ng-container",3),b.Ac(5,f,37,14,"ng-container",3),b.Nb(),b.Pb(),b.Qb(6,"ion-footer"),b.Ac(7,p,4,0,"ion-toolbar",4),b.Pb()),2&o&&(b.hc("titulo","Registro de<br /> <b>Jornada</b>")("voltar",!0)("icone","navigate-circle-outline")("exibirAvatar",!1),b.zb(2),b.hc("ngIf",null!=i.ultimoRegistro),b.zb(1),b.hc("ngSwitch",i.novoRegistro),b.zb(1),b.hc("ngSwitchCase",!1),b.zb(1),b.hc("ngSwitchCase",!0),b.zb(2),b.hc("ngIf",i.novoRegistro))},directives:[O.a,e.u,n.t,n.x,n.y,e.z,n.q,e.O,e.H,e.N,e.C,e.eb,e.gb,e.t,e.zb,e.k],pipes:[P.c],styles:[".saida[_ngcontent-%COMP%]   b[_ngcontent-%COMP%], .saida[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:red}.listOpcoes[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{padding-left:10px}.listOpcoes[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:700}ion-footer[_ngcontent-%COMP%]:before{display:none;visibility:hidden}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:transparent}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;--padding-start:0;--padding-end:0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;height:56px;position:relative;display:block;margin:0;border-radius:0;font-weight:700}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.azul[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-azul)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.rosa[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-rosa)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.verde[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-verde)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.amarelo[_ngcontent-%COMP%]{--ion-color-base:#000!important;--ion-color-contrast:var(--ion-color-amarelo)!important}.tipo-E[_ngcontent-%COMP%]{color:var(--ion-color-verde)}.tipo-S[_ngcontent-%COMP%]{color:red}"]}),o})()}];let E=(()=>{class o{}return o.\u0275mod=b.Jb({type:o}),o.\u0275inj=b.Ib({factory:function(i){return new(i||o)},imports:[[a.k.forChild(S)],a.k]}),o})();var R=t("HBpY");let M=(()=>{class o{}return o.\u0275mod=b.Jb({type:o}),o.\u0275inj=b.Ib({factory:function(i){return new(i||o)},imports:[[n.c,s.e,e.Bb,P.l,R.a,E]]}),o})()}}]);