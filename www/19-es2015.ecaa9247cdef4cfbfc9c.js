(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{H9rt:function(o,t,i){"use strict";i.r(t),i.d(t,"AcademicoAvaliacaoNovoPageModule",(function(){return P}));var n=i("ofXK"),a=i("3Pt+"),e=i("TEn/"),s=i("Y4DA"),r=i("tyNb"),c=i("mrSG"),d=i("amDQ"),l=i("wd/R"),u=i("fXoL"),h=i("afdR"),b=i("g8ne"),g=i("h1Pb"),O=i("cI5j");function C(o,t){if(1&o&&(u.Qb(0,"ion-select-option",17),u.Cc(1),u.Pb()),2&o){const o=t.$implicit;u.ic("value",o.IDF_DISCIPLINA),u.zb(1),u.Dc(o.DES_DISCIPLINA)}}function D(o,t){if(1&o){const o=u.Rb();u.Qb(0,"ion-select",15),u.Yb("ionChange",(function(){return u.sc(o),u.bc().getPeriodos()}))("ngModelChange",(function(t){return u.sc(o),u.bc().dados.idDisciplina=t})),u.Ac(1,C,2,2,"ion-select-option",16),u.Pb()}if(2&o){const o=u.bc();u.hc("cancelText","Cancelar")("ngModel",o.dados.idDisciplina),u.zb(1),u.hc("ngForOf",o.data.MOB_DISCIPLINAS)}}function f(o,t){if(1&o&&(u.Qb(0,"ion-select-option",17),u.Cc(1),u.Pb()),2&o){const o=t.$implicit;u.ic("value",o.IDF_ETAPA),u.zb(1),u.Ec(" ",o.TITULO,"")}}function p(o,t){if(1&o){const o=u.Rb();u.Qb(0,"ion-select",19),u.Yb("ngModelChange",(function(t){return u.sc(o),u.bc(2).dados.idPeriodo=t})),u.Ac(1,f,2,2,"ion-select-option",16),u.Pb()}if(2&o){const o=u.bc(2);u.hc("cancelText","Cancelar")("ngModel",o.dados.idPeriodo),u.zb(1),u.hc("ngForOf",o.data.MOB_CONTEUDO)}}function I(o,t){if(1&o&&(u.Qb(0,"ion-item"),u.Qb(1,"ion-label",3),u.Mb(2,"ion-icon",4),u.Cc(3," Per\xedodo avaliativo * "),u.Pb(),u.Ac(4,p,2,3,"ion-select",18),u.Pb()),2&o){const o=u.bc();u.zb(4),u.hc("ngIf",o.data.MOB_CONTEUDO.length>0)}}const A=[{path:"",component:(()=>{class o{constructor(o,t,i,n,a,e,s){this.cub3Svc=o,this.location=t,this.cd=i,this.cub3Db=n,this.selector=a,this.route=e,this.router=s,this.turmaAtiva={NME_TURMA:""},this.dados={IDF_AULA:"",IDF_CONTEUDO:"",DAT_AULA:"",IDF_TURMA:"",IDF_PROFISSIONAL:"",NRO_AVALIACAO:"",IDF_DISCIPLINA:"",DES_ASSUNTO:"",OBSERVACAO:"",SIT_REGISTRO:"",IDF_CONTEUDOS:[]},this.tipoCadastro="INDIVIDUAL",this.diasSemana=[],this.plAula=[],this.conteudos=[],this.data={MOB_DISCIPLINAS:[],MOB_PLAULA:[]},this.usuario=d.a.getAccount(),this.carregando=!0,this.wizard=1,this.mesesCal=["Jan","Fev","Mar","Abr","Jun","Jul","Ago","Set","Out","Nov","Dez"],this.diasCal=["S","T","Q","Q","S","S","D"],this.jsonData={duracao:[]}}ngOnInit(){for(var o=0;o<=120;o++)o%10==0&&this.jsonData.duracao.push({description:o+" minutos"});this.route.url.subscribe(()=>{this.route.snapshot.params.id&&"undefined"!=this.route.snapshot.params.id&&(this.turmaAtiva.IDF_TURMA=this.route.snapshot.params.id,this.init())})}getPeriodos(){return Object(c.a)(this,void 0,void 0,(function*(){try{const o=this.data.MOB_DISCIPLINAS.find(o=>o.IDF_DISCIPLINA===this.dados.idDisciplina);if(!o)return void console.error("Disciplina n\xe3o encontrada.");const t=d.a.getItem("escolas");if(console.log("Escolas",o.DES_DISCIPLINA.trim()),!t||!t.conteudo)return void console.error("Dados de escolas n\xe3o est\xe3o dispon\xedveis ou mal formados.");const i=[t.conteudo.find(t=>t.DES_DISCIPLINA.trim()===o.DES_DISCIPLINA.trim())];if(console.log("Conteudo",i),!i)return void console.error("Conte\xfado correspondente n\xe3o encontrado.");this.data.MOB_CONTEUDO=i,console.log("Disciplina encontrada: ",this.data.MOB_CONTEUDO)}catch(o){console.error("Erro ao buscar per\xedodos:",o)}finally{this.cd.markForCheck()}}))}iniciarTurma(){return Object(c.a)(this,void 0,void 0,(function*(){this.data=d.a.getItem("data"),this.getDisciplinas()}))}listarTurmas(o){let t=[];return o.forEach(o=>{o.turmas.forEach(o=>{t.push(o)})}),t}getDisciplinas(){return Object(c.a)(this,void 0,void 0,(function*(){let o=(yield this.cub3Svc.getTurmas()).find(o=>o.id==this.turmaAtiva.IDF_TURMA);this.turmaAtiva=o,console.log("Turma",o),this.data.MOB_DISCIPLINAS=this.turmaAtiva.disciplinas,this.cd.markForCheck()}))}init(){this.turma=this.turmaAtiva.IDF_TURMA,console.log("Iniciando turma",this.turmaAtiva),this.tipoCadastro="I",this.dados={IDF_AULA:Math.floor(1e3*Math.random())+1,DAT_AULA:new Date,IDF_TURMA:this.turma,IDF_DISCIPLINA:"",NRO_AVALIACAO:null,IDF_PROFISSIONAL:this.usuario.id,IDF_CONTEUDO:"I",DES_ASSUNTO:"",OBSERVACAO:"",SIT_REGISTRO:"PENDENTE",IDF_PLAULA:"",IDF_CONTEUDOS:[]},this.iniciarTurma()}gerarDatasEntre(o,t,i){const n=[];let a=new Date(o);const e=new Date(t);for(;a<=e;)i.includes(this.DiaDaSemana(a))&&n.push(this.formatarData(a)),a.setDate(a.getDate()+1);return n}DiaDaSemana(o){return["domingo","segunda","terca","quarta","quinta","sexta","sabado"][o.getDay()]}formatarData(o){return`${o.getDate().toString().padStart(2,"0")}/${(o.getMonth()+1).toString().padStart(2,"0")}/${o.getFullYear()}`}submit(){return Object(c.a)(this,void 0,void 0,(function*(){let o=[];o=[{id:"idDisciplina",label:"Disciplina"},{id:"tipo",label:"Tipo de avalia\xe7\xe3o"},{id:"titulo",label:"Nome da avalia\xe7\xe3o"}];let t=[];for(let a of o)this.dados[a.id]&&""!=this.dados[a.id]||t.push(a.label);if(t.length>0){let o=t.join(", ");this.cub3Svc.alerta("Ops!","Campo(s) obrigat\xf3rio(s): <b>"+o+"</b>")}else{let o=this.dados,a=yield this.cub3Svc.carregar(1);if(0===t.length)try{const t={id:Math.floor(1e3*Math.random())+1,idDisciplina:o.idDisciplina,idPeriodo:o.idPeriodo,tipo:o.tipo,titulo:o.titulo};try{this.cub3Db.add("MOB_REGISTRO_AVALIACAO",t).then(()=>{a.dismiss(),this.cub3Svc.sincronizar("MOB_REGISTRO_AVALIACAO").then(()=>{this.cub3Svc.alerta("Registro de avalia\xe7\xe3o","Registro enviado com sucesso!"),this.location.back()},()=>{this.cub3Svc.alerta("Registro de avalia\xe7\xe3o","Registro inserido com sucesso!"),this.location.back()})},o=>{a.dismiss(),this.cub3Svc.alerta("Ocorreu um problema","Por favor, verifique os campos obrigat\xf3rios da avalia\xe7\xe3o."),console.log(o)})}catch(i){a.dismiss()}}catch(n){a.dismiss(),console.error(n)}}}))}getPlaula(){return Object(c.a)(this,void 0,void 0,(function*(){if(this.plAula=[],!this.data||!this.data.MOB_PLAULA||!this.dados||"function"!=typeof this.verificarTurma)return void console.error("Data, dados or verificarTurma is not defined");let o=this.data.MOB_PLAULA.filter(o=>this.verificarTurma(o.IDF_TURMA)&&o.IDF_DISCIPLINA==this.dados.IDF_DISCIPLINA);this.plAula=o}))}getConteudos(){return Object(c.a)(this,void 0,void 0,(function*(){this.data.CONTEUDOS=[];const o=yield this.cub3Svc.getNode("educanet/profissional/conteudoItens?idf_disciplina="+this.dados.IDF_DISCIPLINA);o&&o.dados&&(this.conteudos=o.dados);const t=this.conteudos;if(t){console.log(t);for(let o of t)if(this.verificarTurma(o.IDF_TURMA)&&this.dados.IDF_PLAULA==o.IDF_PLAULA){this.dados.NRO_AVALIACAO=o.NRO_AVALIACAO;for(let t of o.CONTEUDOS)this.data.CONTEUDOS.push(t)}}}))}atualizarConteudos(o=null){return Object(c.a)(this,void 0,void 0,(function*(){this.dados.CONTEUDOS=[];for(let o of this.dados.IDF_CONTEUDOS)for(let t of this.data.CONTEUDOS)t.IDF_CONTEUDO==o&&this.dados.CONTEUDOS.push(t)}))}verificarTurma(o){try{const t=o.split(",");let i=!1;for(let o of t)o==this.turmaAtiva.IDF_TURMA&&(i=!0);return i}catch(t){return!1}}selecionarData(o){this.dados.DAT_AULA=l(o),this.wizard=2}selecionarDisciplina(o){this.dados.IDF_DISCIPLINA=o,this.getPlaula(),this.wizard=3}selecionarPlanoAula(o,t=null){o?(this.dados.IDF_PLAULA=o,this.dados.NRO_AVALIACAO=t,console.log(this.dados),this.getConteudos(),this.wizard=4):this.wizard=5}voltar(){this.wizard=this.wizard>1?this.wizard-1:1}selecionarDuracao(o){try{this.selector.show({title:"Dura\xe7\xe3o de apresenta\xe7\xe3o do conte\xfado:",items:[this.jsonData.duracao],positiveButtonText:"Selecionar",negativeButtonText:"Cancelar"}).then(t=>{o.DURACAO=t[0].description.split(" ")[0]},o=>console.log("Error: ",o))}catch(t){console.log(t.message)}}selecionarConteudo(o){if(this.verificarConteudo(o))for(let t of this.dados.IDF_CONTEUDOS)o.IDF_CONTEUDO==t.IDF_CONTEUDO&&this.dados.IDF_CONTEUDOS.splice(this.dados.IDF_CONTEUDOS.indexOf(t),1);else this.dados.IDF_CONTEUDOS.push(o)}verificarConteudo(o){let t=!1;for(let i of this.dados.IDF_CONTEUDOS)o.IDF_CONTEUDO==i.IDF_CONTEUDO&&(t=!0);return t}avancar(){switch(this.wizard){case 4:this.wizard=5;break;case 5:this.submit()}}}return o.\u0275fac=function(t){return new(t||o)(u.Lb(h.a),u.Lb(n.n),u.Lb(u.h),u.Lb(b.a),u.Lb(g.a),u.Lb(r.a),u.Lb(r.g))},o.\u0275cmp=u.Fb({type:o,selectors:[["app-academico-avaliacao-novo"]],decls:36,vars:9,consts:[[3,"titulo","voltar","icone","exibirAvatar"],["id","container"],[1,"header4"],["position","floating"],["name","book-outline"],["placeholder","Selecione uma disciplina","name","disciplina",3,"cancelText","ngModel","ionChange","ngModelChange",4,"ngIf"],[4,"ngIf"],["placeholder","Selecione um tipo","name","tipo",3,"cancelText","ngModel","ngModelChange"],["value","NORMAL"],["value","EXTRA"],["value","RECUPERACAO"],["placeholder","Nome da avalia\xe7\xe3o *","name","assunto",3,"ngModel","ngModelChange"],["vertical","bottom","horizontal","end","slot","fixed"],["color","success",3,"click"],["name","checkmark-circle-outline"],["placeholder","Selecione uma disciplina","name","disciplina",3,"cancelText","ngModel","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Selecione um per\xedodo","name","periodo",3,"cancelText","ngModel","ngModelChange",4,"ngIf"],["placeholder","Selecione um per\xedodo","name","periodo",3,"cancelText","ngModel","ngModelChange"]],template:function(o,t){1&o&&(u.Mb(0,"cub3-header",0),u.Qb(1,"ion-content"),u.Qb(2,"div",1),u.Qb(3,"ion-row"),u.Qb(4,"ion-col"),u.Qb(5,"h4",2),u.Qb(6,"b"),u.Cc(7,"Informa\xe7\xf5es sobre nova avalia\xe7\xe3o"),u.Pb(),u.Mb(8,"br"),u.Qb(9,"small"),u.Cc(10,"Selecione um tipo de avalia\xe7\xe3o e preencha as informa\xe7\xf5es relevantes:"),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Qb(11,"ion-card"),u.Qb(12,"ion-card-content"),u.Qb(13,"ion-list"),u.Qb(14,"ion-item"),u.Qb(15,"ion-label",3),u.Mb(16,"ion-icon",4),u.Cc(17," Disciplina * "),u.Pb(),u.Ac(18,D,2,3,"ion-select",5),u.Pb(),u.Ac(19,I,5,1,"ion-item",6),u.Qb(20,"ion-item"),u.Qb(21,"ion-label",3),u.Mb(22,"ion-icon",4),u.Cc(23," Tipo de avalia\xe7\xe3o * "),u.Pb(),u.Qb(24,"ion-select",7),u.Yb("ngModelChange",(function(o){return t.dados.tipo=o})),u.Qb(25,"ion-select-option",8),u.Cc(26,"Normal"),u.Pb(),u.Qb(27,"ion-select-option",9),u.Cc(28,"Ponto extra"),u.Pb(),u.Qb(29,"ion-select-option",10),u.Cc(30,"Recupera\xe7\xe3o parcial"),u.Pb(),u.Pb(),u.Pb(),u.Qb(31,"ion-item"),u.Qb(32,"ion-textarea",11),u.Yb("ngModelChange",(function(o){return t.dados.titulo=o})),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Qb(33,"ion-fab",12),u.Qb(34,"ion-fab-button",13),u.Yb("click",(function(){return t.submit()})),u.Mb(35,"ion-icon",14),u.Pb(),u.Pb(),u.Pb()),2&o&&(u.hc("titulo","Nova <br /> <b>avalia\xe7\xe3o</b>")("voltar",!0)("icone","bookmarks-outline")("exibirAvatar",!1),u.zb(18),u.hc("ngIf",t.data.MOB_DISCIPLINAS.length>0),u.zb(1),u.hc("ngIf",t.data.MOB_CONTEUDO),u.zb(5),u.hc("cancelText","Cancelar")("ngModel",t.dados.tipo),u.zb(8),u.hc("ngModel",t.dados.titulo))},directives:[O.a,e.u,e.gb,e.t,e.m,e.n,e.O,e.H,e.N,e.C,n.t,e.kb,e.Lb,a.j,a.m,e.lb,e.vb,e.Mb,e.w,e.x,n.s],styles:["ion-footer[_ngcontent-%COMP%]:before{display:none;visibility:hidden}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:transparent}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;--padding-start:0;--padding-end:0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;height:56px;position:relative;display:block;margin:0;border-radius:0;font-weight:700}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.azul[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-azul)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.rosa[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-rosa)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.verde[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-verde)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.amarelo[_ngcontent-%COMP%]{--ion-color-base:#000!important;--ion-color-contrast:var(--ion-color-amarelo)!important}ion-card[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:0}ion-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{--background:#fafafa}.btnVoltar[_ngcontent-%COMP%]{position:absolute;top:0;right:5px;font-size:.7em}.listOpcoes[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{width:100%}ion-card[_ngcontent-%COMP%]{background:#fafafa;padding:10px}ion-card[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{float:right}ion-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{width:100%}.ativado[_ngcontent-%COMP%]{background:hsla(0,0%,81.6%,.4)!important}ion-label[_ngcontent-%COMP%]{font-weight:700}ion-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}ion-item[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),o})()}];let m=(()=>{class o{}return o.\u0275mod=u.Jb({type:o}),o.\u0275inj=u.Ib({factory:function(t){return new(t||o)},imports:[[r.k.forChild(A)],r.k]}),o})();var _=i("HBpY");let P=(()=>{class o{}return o.\u0275mod=u.Jb({type:o}),o.\u0275inj=u.Ib({factory:function(t){return new(t||o)},imports:[[n.c,a.e,e.Bb,s.a,_.a,m]]}),o})()}}]);