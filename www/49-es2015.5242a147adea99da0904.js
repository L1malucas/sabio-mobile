(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{JenN:function(o,n,t){"use strict";t.r(n),t.d(n,"AcademicoTurmaNotaAlunoPageModule",(function(){return M}));var i=t("ofXK"),a=t("3Pt+"),e=t("TEn/"),c=t("tyNb"),s=t("mrSG"),r=t("amDQ"),l=t("fXoL"),b=t("h1Pb"),u=t("afdR"),d=t("g8ne"),A=t("cI5j");function f(o,n){if(1&o){const o=l.Rb();l.Qb(0,"ion-item",7),l.Yb("click",(function(){return l.sc(o),l.bc(3).selecionarNotas()})),l.Qb(1,"p"),l.Qb(2,"b"),l.Cc(3,"Nota:"),l.Pb(),l.Pb(),l.Qb(4,"ion-badge",9),l.Cc(5),l.Pb(),l.Pb()}if(2&o){const o=l.bc(3);l.zb(5),l.Dc(o.aluno.NOTA.NOTA)}}function I(o,n){if(1&o){const o=l.Rb();l.Qb(0,"ion-col",13),l.Qb(1,"ion-button",15),l.Yb("click",(function(){return l.sc(o),l.bc(3).selecionarNotas()})),l.Cc(2,"Alterar nota"),l.Pb(),l.Pb()}}function h(o,n){if(1&o){const o=l.Rb();l.Qb(0,"ion-card-content"),l.Qb(1,"ion-list"),l.Qb(2,"ion-item",7),l.Yb("click",(function(){return l.sc(o),l.bc(2).selecionarFaltas()})),l.Qb(3,"p"),l.Qb(4,"b"),l.Cc(5,"Faltas:"),l.Pb(),l.Pb(),l.Qb(6,"ion-badge",8),l.Cc(7),l.Pb(),l.Pb(),l.Qb(8,"ion-item"),l.Qb(9,"p"),l.Qb(10,"b"),l.Cc(11,"Tipo de avalia\xe7\xe3o:"),l.Pb(),l.Pb(),l.Qb(12,"ion-badge",9),l.Cc(13),l.Pb(),l.Pb(),l.Ac(14,f,6,1,"ion-item",10),l.Pb(),l.Mb(15,"br"),l.Qb(16,"ion-row",11),l.Ac(17,I,3,0,"ion-col",12),l.Qb(18,"ion-col",13),l.Qb(19,"ion-button",14),l.Yb("click",(function(){return l.sc(o),l.bc(2).selecionarFaltas()})),l.Cc(20,"Alterar faltas"),l.Pb(),l.Pb(),l.Pb(),l.Pb()}if(2&o){const o=l.bc(2);l.zb(7),l.Dc(o.aluno.NOTA.FALTAS),l.zb(6),l.Dc("NOTA"==o.aluno.NOTA.TIP_AVALIACAO?"Nota":"Conceito"),l.zb(1),l.hc("ngIf","NOTA"==o.aluno.NOTA.TIP_AVALIACAO),l.zb(3),l.hc("ngIf","NOTA"==o.aluno.NOTA.TIP_AVALIACAO)}}function O(o,n){if(1&o&&(l.Qb(0,"ion-card"),l.Ac(1,h,21,4,"ion-card-content",3),l.Pb()),2&o){const o=l.bc();l.zb(1),l.hc("ngIf",o.aluno.NOTA)}}function P(o,n){if(1&o&&(l.Qb(0,"ion-row"),l.Qb(1,"ion-col"),l.Qb(2,"ion-label"),l.Cc(3),l.Pb(),l.Pb(),l.Qb(4,"ion-col"),l.Qb(5,"ion-label"),l.Cc(6),l.Pb(),l.Pb(),l.Pb()),2&o){const o=n.$implicit;l.zb(3),l.Dc(o.DES_AVALIACAO),l.zb(3),l.Dc(o.MEDIA_PERIODO||"-")}}function g(o,n){if(1&o&&(l.Qb(0,"ion-grid"),l.Qb(1,"ion-row"),l.Qb(2,"ion-col"),l.Qb(3,"ion-label"),l.Cc(4,"Per\xedodo - M\xe9dia"),l.Pb(),l.Pb(),l.Pb(),l.Ac(5,P,7,2,"ion-row",4),l.Pb()),2&o){const o=l.bc(2).$implicit;l.zb(5),l.hc("ngForOf",o.rendimento)}}function p(o,n){1&o&&l.Cc(0," Rendimento n\xe3o dispon\xedvel ")}function C(o,n){if(1&o&&(l.Qb(0,"ion-list"),l.Qb(1,"ion-card"),l.Qb(2,"ion-card-content"),l.Ac(3,g,6,1,"ion-grid",16),l.Ac(4,p,1,0,"ng-template",null,17,l.Bc),l.Pb(),l.Pb(),l.Pb()),2&o){const o=l.rc(5),n=l.bc().$implicit;l.zb(3),l.hc("ngIf",n.rendimento&&n.rendimento.length>0)("ngIfElse",o)}}function m(o,n){if(1&o&&(l.Ob(0),l.Ac(1,C,6,2,"ion-list",3),l.Nb()),2&o){const o=n.$implicit,t=l.bc();l.zb(1),l.hc("ngIf",o.IDF_DISCIPLINA==t.aluno.NOTA.IDF_DISCIPLINA)}}const _=[{path:"",component:(()=>{class o{constructor(o,n,t,i,a,e,c){this.route=o,this.router=n,this.location=t,this.navCtrl=i,this.selector=a,this.cub3Svc=e,this.cub3Db=c,this.turmaAtiva={NME_TURMA:""},this.data={MOB_DISCIPLINAS:[],MOB_AVALIACOES:[]},this.dados={},this.carregando=!0,this.aluno={},this.nota={},this.jsonData={notas1:[],notas2:[],faltas:[]}}ngOnInit(){this.route.url.subscribe(()=>{this.route.snapshot.params.aluno&&"undefined"!=this.route.snapshot.params.aluno?(this.aluno=JSON.parse(atob(this.route.snapshot.params.aluno)),this.init()):this.location.back()})}init(){this.data=r.a.getItem("data"),null!=this.aluno&&(this.nota=this.aluno.NOTA.NOTA),console.log("Aluno",this.aluno),this.getDisciplinas(),this.popularFaltas(),this.popularNotas()}popularNotas(){for(var o=0;o<=10;o++)this.jsonData.notas1.push({description:o+""});for(var n=0;n<=9;n++)this.jsonData.notas2.push({description:"."+n})}popularFaltas(){for(var o=0;o<=30;o++)this.jsonData.faltas.push({description:o+""})}selecionarFaltas(){try{this.selector.show({title:"Qual o n\xfamero de faltas?",items:[this.jsonData.faltas],positiveButtonText:"Selecionar",negativeButtonText:"Cancelar"}).then(o=>{console.log(o[0].description+" at index: "+o[0].index),this.aluno.NOTA.FALTAS=o[0].description},o=>console.log("Error: ",o))}catch(o){console.log(o.message)}}selecionarNotas(){try{this.selector.show({title:"Qual a nota da avalia\xe7\xe3o?",items:[this.jsonData.notas1,this.jsonData.notas2],positiveButtonText:"Selecionar",negativeButtonText:"Cancelar"}).then(o=>{console.log(o[0].val+" at index: "+o[0].index),this.aluno.NOTA.NOTA=o[0].description+""+o[1].description},o=>console.log("Error: ",o))}catch(o){console.log(o.message)}}getDisciplinas(){return Object(s.a)(this,void 0,void 0,(function*(){let o=yield this.cub3Svc.getTurmas();const n=o.find(o=>o.IDF_TURMA==this.aluno.IDF_TURMA);let t=n.NME_DISCIPLINA;o.find(o=>o.IDF_TURMA==this.aluno.IDF_TURMA)&&(this.data.MOB_DISCIPLINAS=t||[],console.log("Disciplinas",n),this.calcularRendimento())}))}calcularRendimento(){const o=new URLSearchParams({conceito:"0",idf_aluno:this.aluno.IDF_ALUNO,idf_turma:this.aluno.IDF_TURMA}).toString();this.cub3Svc.getNode("educanet/aluno/avaliacoes/listarRendimento?"+o).then(o=>{if(this.data.MOB_DISCIPLINAS.length>0&&o&&o.dados){const n=o.dados,t=this.data.MOB_DISCIPLINAS;for(let o of t)o.rendimento=[];for(let o of n){const n=t.findIndex(n=>n.IDF_DISCIPLINA==o.IDF_DISCIPLINA);n>-1&&(t[n].rendimento?t[n].rendimento.push(o):t[n].rendimento=[o])}console.log("Disciplinas",[t,n])}},o=>{})}voltarRota(){this.navCtrl.back()}salvar(){let o=this.data.MOB_AVALIACOES_ALUNOS;if(console.log("Avalia\xe7\xf5es do aluno",o),o){for(let n of o)if(n.IDF_AVALIACAO==this.aluno.NOTA.IDF_AVALIACAO&&n.IDF_ALUNO==this.aluno.IDF_ALUNO){n.FALTAS=this.aluno.NOTA.FALTAS,n.NOTA=this.aluno.NOTA.NOTA;const o=this.data.MOB_AVALIACOES.find(o=>o.IDF_AVALIACAO==n.IDF_AVALIACAO);this.updateMediaRendimento(n.IDF_DISCIPLINA,n.NOTA,this.aluno.IDF_ALUNO,o)}r.a.setItem("data",this.data)}this.cub3Svc.alertaToast("Atualiza\xe7\xe3o de nota","Realizada com sucesso")}updateMediaRendimento(o,n,t,i){let a=this.data.MOB_DISCIPLINAS;const e=a.findIndex(n=>n.IDF_DISCIPLINA==o);if(e>-1){let o=a[e],c=o.rendimento||[],s=0,r=0;console.log("Atualizando rendimento",o.rendimento),c.forEach(o=>{console.log("Aluno",[o.IDF_ALUNO,t]),o.IDF_ALUNO===t&&(console.log("Avaliacao",[o.IDF_AVALIACAO,i]),o.IDF_AVALIACAO==i&&(o.FALTAS=n.FALTAS,o.MEDIA_PERIODO=parseFloat(n.NOTA)),s+=o.MEDIA_PERIODO,r++)}),o.MEDIA_RENDIMENTO=r>0?s/r:0}console.log("Disciplinas",a)}}return o.\u0275fac=function(n){return new(n||o)(l.Lb(c.a),l.Lb(c.g),l.Lb(i.n),l.Lb(e.Fb),l.Lb(b.a),l.Lb(u.a),l.Lb(d.a))},o.\u0275cmp=l.Fb({type:o,selectors:[["app-academico-turma-nota-aluno"]],decls:20,vars:6,consts:[[3,"titulo","voltar","icone","exibirAvatar"],[1,"header4"],["name","frmNota"],[4,"ngIf"],[4,"ngFor","ngForOf"],["footer",""],["color","danger",3,"click"],[3,"click"],["color","primary","slot","end"],["color","secondary","slot","end"],[3,"click",4,"ngIf"],[1,"box-notas"],["size","6",4,"ngIf"],["size","6"],["full","","color","primary",3,"click"],["full","","color","secondary",3,"click"],[4,"ngIf","ngIfElse"],["semRendimento",""]],template:function(o,n){1&o&&(l.Mb(0,"cub3-header",0),l.Qb(1,"ion-content"),l.Qb(2,"ion-row"),l.Qb(3,"ion-col"),l.Qb(4,"h4",1),l.Cc(5,"Lan\xe7amento de "),l.Qb(6,"b"),l.Cc(7,"avalia\xe7\xe3o"),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(8,"form",2),l.Ac(9,O,2,1,"ion-card",3),l.Pb(),l.Qb(10,"ion-header"),l.Qb(11,"ion-toolbar"),l.Qb(12,"ion-title"),l.Cc(13," Rendimento do aluno "),l.Pb(),l.Pb(),l.Pb(),l.Ac(14,m,2,1,"ng-container",4),l.Pb(),l.Qb(15,"ion-footer"),l.Qb(16,"ion-toolbar",null,5),l.Qb(18,"ion-button",6),l.Yb("click",(function(){return n.salvar()})),l.Cc(19," Confirmar "),l.Pb(),l.Pb(),l.Pb()),2&o&&(l.hc("titulo","Nota <br /> <b>"+n.aluno.NME_ALUNO+"</b>")("voltar",!0)("icone","bookmarks-outline")("exibirAvatar",!1),l.zb(9),l.hc("ngIf",null!=n.aluno&&null!=n.aluno),l.zb(5),l.hc("ngForOf",n.data.MOB_DISCIPLINAS))},directives:[A.a,e.u,e.gb,e.t,a.x,a.k,a.l,i.t,e.B,e.zb,e.xb,i.s,e.z,e.k,e.m,e.n,e.O,e.H,e.j,e.A,e.N],styles:["ion-footer[_ngcontent-%COMP%]:before{display:none;visibility:hidden}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:transparent}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;--padding-start:0;--padding-end:0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;height:56px;position:relative;display:block;margin:0;border-radius:0;font-weight:700}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.azul[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-azul)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.rosa[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-rosa)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.verde[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-verde)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.amarelo[_ngcontent-%COMP%]{--ion-color-base:#000!important;--ion-color-contrast:var(--ion-color-amarelo)!important}ion-card[_ngcontent-%COMP%]{background:#fafafa}ion-card[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:0}ion-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{--background:#fafafa}.box-notas[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}"]}),o})()}];let N=(()=>{class o{}return o.\u0275mod=l.Jb({type:o}),o.\u0275inj=l.Ib({factory:function(n){return new(n||o)},imports:[[c.k.forChild(_)],c.k]}),o})();var D=t("HBpY");let M=(()=>{class o{}return o.\u0275mod=l.Jb({type:o}),o.\u0275inj=l.Ib({factory:function(n){return new(n||o)},imports:[[i.c,a.e,e.Bb,D.a,N]]}),o})()}}]);