function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var t,e={},n=Object.prototype,o=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new M(o||[]);return r(a,"_invoke",{value:w(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",b="executing",g="completed",d={};function p(){}function v(){}function O(){}var m={};u(m,a,(function(){return this}));var C=Object.getPrototypeOf,y=C&&C(C(L([])));y&&y!==n&&o.call(y,a)&&(m=y);var _=O.prototype=p.prototype=Object.create(m);function A(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(r,i,a,c){var s=f(t[r],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&o.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;r(this,"_invoke",{value:function(t,o){function r(){return new e((function(e,r){n(t,o,e,r)}))}return i=i?i.then(r,r):r()}})}function w(e,n,o){var r=h;return function(i,a){if(r===b)throw new Error("Generator is already running");if(r===g){if("throw"===i)throw a;return{value:t,done:!0}}for(o.method=i,o.arg=a;;){var c=o.delegate;if(c){var s=I(c,o);if(s){if(s===d)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===h)throw r=g,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=b;var u=f(e,n,o);if("normal"===u.type){if(r=o.done?g:"suspendedYield",u.arg===d)continue;return{value:u.arg,done:o.done}}"throw"===u.type&&(r=g,o.method="throw",o.arg=u.arg)}}}function I(e,n){var o=n.method,r=e.iterator[o];if(r===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),d;var i=f(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function L(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(o.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return v.prototype=O,r(_,"constructor",{value:O,configurable:!0}),r(O,"constructor",{value:v,configurable:!0}),v.displayName=u(O,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,O):(t.__proto__=O,u(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},e.awrap=function(t){return{__await:t}},A(P.prototype),u(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,o,r,i){void 0===i&&(i=Promise);var a=new P(l(t,n,o,r),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},A(_),u(_,s,"Generator"),u(_,a,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},e.values=L,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(o,r){return c.type="throw",c.arg=e,n.next=o,r&&(n.method="next",n.arg=t),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:L(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),d}},e}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,_toPropertyKey(o.key),o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==typeof e?e:String(e)}function _toPrimitive(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{JIsf:function(t,e,n){"use strict";n.r(e),n.d(e,"AcademicoOcorrenciaNovoPageModule",(function(){return A}));var o=n("ofXK"),r=n("3Pt+"),i=n("TEn/"),a=n("tyNb"),c=n("mrSG"),s=n("amDQ"),u=n("wd/R"),l=n("fXoL"),f=n("afdR"),h=n("g8ne"),b=n("cI5j");function g(t,e){if(1&t&&(l.Qb(0,"ion-select-option",13),l.Cc(1),l.Pb()),2&t){var n=e.$implicit,o=l.bc(2);l.hc("value",n.id),l.zb(1),l.Dc(o.cub3Svc.normalizeString(n.nome))}}function d(t,e){if(1&t&&(l.Qb(0,"ion-select-option",13),l.Cc(1),l.Pb()),2&t){var n=e.$implicit;l.hc("value",n.IDF_OCORRENCIA),l.zb(1),l.Dc(n.DES_OCORRENCIA)}}function p(t,e){if(1&t){var n=l.Rb();l.Qb(0,"ion-card-content"),l.Qb(1,"ion-list"),l.Qb(2,"ion-item",5),l.Qb(3,"ion-label"),l.Cc(4,"Aluno *"),l.Pb(),l.Qb(5,"ion-select",6),l.Yb("ngModelChange",(function(t){return l.sc(n),l.bc().ocorrencia.IDF_ALUNO=t})),l.Ac(6,g,2,2,"ion-select-option",7),l.Pb(),l.Pb(),l.Qb(7,"ion-item",5),l.Qb(8,"ion-label"),l.Cc(9,"Tipo de evento *"),l.Pb(),l.Qb(10,"ion-select",8),l.Yb("ngModelChange",(function(t){return l.sc(n),l.bc().ocorrencia.IDF_OCORRENCIA=t})),l.Ac(11,d,2,2,"ion-select-option",7),l.Pb(),l.Pb(),l.Qb(12,"ion-item"),l.Mb(13,"ion-icon",9),l.Qb(14,"ion-textarea",10),l.Yb("ngModelChange",(function(t){return l.sc(n),l.bc().ocorrencia.TXT_OCORRENCIA=t})),l.Pb(),l.Pb(),l.Qb(15,"ion-item"),l.Mb(16,"ion-icon",11),l.Qb(17,"ion-textarea",12),l.Yb("ngModelChange",(function(t){return l.sc(n),l.bc().ocorrencia.OBSERVACAO=t})),l.Pb(),l.Pb(),l.Pb(),l.Pb()}if(2&t){var o=l.bc();l.zb(5),l.hc("ngModel",o.ocorrencia.IDF_ALUNO),l.zb(1),l.hc("ngForOf",o.alunos),l.zb(4),l.hc("ngModel",o.ocorrencia.IDF_OCORRENCIA),l.zb(1),l.hc("ngForOf",o.tipos),l.zb(3),l.hc("ngModel",o.ocorrencia.TXT_OCORRENCIA),l.zb(3),l.hc("ngModel",o.ocorrencia.OBSERVACAO)}}var v,O,m,C=[{path:"",component:(v=function(){function t(e,n,o,r,i,a){_classCallCheck(this,t),this.cub3Svc=e,this.location=n,this.cub3Db=o,this.cd=r,this.route=i,this.router=a,this.turmaAtiva={NME_TURMA:""},this.dados={IDF_AULA:"",DAT_AULA:"",IDF_TURMA:"",IDF_PROFISSIONAL:"",IDF_DISCIPLINA:"",DES_ASSUNTO:"",OBSERVACAO:"",SIT_REGISTRO:""},this.turmas=[],this.data={MOB_DISCIPLINAS:[]},this.usuario=s.a.getAccount(),this.carregando=!0,this.ocorrencia={OBSERVACAO:"",TXT_OCORRENCIA:""},this.alunos=[],this.tipos=[]}return _createClass(t,[{key:"ngOnInit",value:function(){this.init()}},{key:"init",value:function(){this.getAlunos(),this.getTipos()}},{key:"submit",value:function(){return Object(c.a)(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var e,n,o,r,i,a,c,l,f,h,b=this;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=[],n=0,o=[{id:"IDF_OCORRENCIA",label:"Ocorr\xeancia"},{id:"IDF_ALUNO",label:"Aluno"}];n<o.length;n++)r=o[n],this.ocorrencia[r.id]&&""!=this.ocorrencia[r.id]||e.push(r.label);if(!(e.length>0)){t.next=7;break}i=e.join(", "),this.cub3Svc.alerta("Ops!","Campo(s) obrigat\xf3rio(s): <b>"+i+"</b>"),t.next=24;break;case 7:return a={IDF_PROFISSIONAL:this.usuario.id,ANO_LETIVO:this.usuario.ano_letivo,IDF_OCORRENCIA:this.ocorrencia.IDF_OCORRENCIA,DAT_OCORRENCIA:u().format("YYYY-MM-DD HH:mm:ss"),IDF_ALUNO:this.ocorrencia.IDF_ALUNO,OBSERVACAO:this.ocorrencia.OBSERVACAO,TXT_OCORRENCIA:this.ocorrencia.TXT_OCORRENCIA},t.prev=8,t.next=11,this.cub3Svc.carregar(1);case 11:if(c=t.sent,this.data=s.a.getItem("data"),l=this.data.MOB_OCORRENCIA||[],f=this.data.MOB_ALUNOS||[],console.log([l,f]),l&&f){t.next=16;break}return t.abrupt("return");case 16:console.log("Obtendo ocorr\xeancias locais"),h=l.map((function(t){var e=f.find((function(e){return e.IDF_ALUNO==t.IDF_ALUNO}));return e&&e.IDF_ALUNO?Object.assign(Object.assign({},t),{aluno:e}):null})).filter((function(t){return null!==t})),a.IDF_OCORRENCIA_LOCAL=h.length>0?h.length:Math.floor(+new Date/1e3),this.cub3Db.addStorage("MOB_OCORRENCIA",a).then((function(){b.cub3Svc.alerta("Registro de ocorr\xeancia","Registro inserido com sucesso!"),b.location.back(),c.dismiss()}),(function(t){console.log("Ocorreu um erro",t),c.dismiss()})),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(8),console.log("Ocorreu um erro"),this.location.back();case 24:case"end":return t.stop()}}),t,this,[[8,21]])})))}},{key:"getAlunos",value:function(){return Object(c.a)(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.carregando=!0,t.next=3,this.cub3Svc.getTurmas();case 3:return this.turmas=t.sent,t.next=6,this.cub3Svc.listarAlunos(this.turmas);case 6:this.alunos=t.sent,this.alunos.sort((function(t,e){return t.nome.localeCompare(e.nome)})),this.carregando=!1,this.cd.markForCheck();case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getTipos",value:function(){return Object(c.a)(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.data=s.a.getItem("data"),this.carregando=!0,this.tipos=[{IDF_OCORRENCIA:1,DES_OCORRENCIA:"Acidente"},{IDF_OCORRENCIA:2,DES_OCORRENCIA:"Agress\xe3o f\xedsica ao colega"},{IDF_OCORRENCIA:3,DES_OCORRENCIA:"Agress\xe3o f\xedsica ao professor"},{IDF_OCORRENCIA:99,DES_OCORRENCIA:"Outras"}],console.log(this.tipos),this.carregando=!1;case 1:case"end":return t.stop()}}),t,this)})))}}]),t}(),v.\u0275fac=function(t){return new(t||v)(l.Lb(f.a),l.Lb(o.n),l.Lb(h.a),l.Lb(l.h),l.Lb(a.a),l.Lb(a.g))},v.\u0275cmp=l.Fb({type:v,selectors:[["app-academico-ocorrencia-novo"]],decls:15,vars:5,consts:[[3,"titulo","voltar","icone","exibirAvatar"],[1,"header4"],[4,"ngIf"],["footer",""],["color","danger",3,"click"],["no-lines",""],["name","aluno","okText","Selecionar","cancelText","Cancelar","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","ocorrencia","okText","Selecionar","cancelText","Cancelar","required","",3,"ngModel","ngModelChange"],["name","ios-chatboxes-outline","item-left",""],["placeholder","Detalhes ou observa\xe7\xf5es do evento...","rows","4","required","","name","detalhes",3,"ngModel","ngModelChange"],["name","ios-mail-outline","item-left",""],["placeholder","Observa\xe7\xe3o...","rows","4","name","observacao",3,"ngModel","ngModelChange"],[3,"value"]],template:function(t,e){1&t&&(l.Mb(0,"cub3-header",0),l.Qb(1,"ion-content"),l.Qb(2,"ion-row"),l.Qb(3,"ion-col"),l.Qb(4,"h4",1),l.Cc(5," Formul\xe1rio de novo registro de "),l.Qb(6,"b"),l.Cc(7,"evento"),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(8,"ion-card"),l.Ac(9,p,18,6,"ion-card-content",2),l.Pb(),l.Pb(),l.Qb(10,"ion-footer"),l.Qb(11,"ion-toolbar",null,3),l.Qb(13,"ion-button",4),l.Yb("click",(function(){return e.submit()})),l.Cc(14," Confirmar "),l.Pb(),l.Pb(),l.Pb()),2&t&&(l.hc("titulo","Novo <br /> <b>evento</b>")("voltar",!0)("icone","bookmarks-outline")("exibirAvatar",!1),l.zb(9),l.hc("ngIf",!e.carregando))},directives:[b.a,i.u,i.gb,i.t,i.m,o.t,i.z,i.zb,i.k,i.n,i.O,i.H,i.N,i.kb,i.Lb,r.t,r.j,r.m,o.s,i.C,i.vb,i.Mb,i.lb],styles:["ion-footer[_ngcontent-%COMP%]:before{display:none;visibility:hidden}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:transparent}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]{--padding-top:0;--padding-bottom:0;--padding-start:0;--padding-end:0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;height:56px;position:relative;display:block;margin:0;border-radius:0;font-weight:700}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.azul[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-azul)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.rosa[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-rosa)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.verde[_ngcontent-%COMP%]{--ion-color-base:#fff!important;--ion-color-contrast:var(--ion-color-verde)!important}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button.amarelo[_ngcontent-%COMP%]{--ion-color-base:#000!important;--ion-color-contrast:var(--ion-color-amarelo)!important}ion-card[_ngcontent-%COMP%]{background:#fafafa}ion-card[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:0}ion-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{--background:#fafafa}"],changeDetection:0}),v)}],y=((O=_createClass((function t(){_classCallCheck(this,t)}))).\u0275mod=l.Jb({type:O}),O.\u0275inj=l.Ib({factory:function(t){return new(t||O)},imports:[[a.k.forChild(C)],a.k]}),O),_=n("HBpY"),A=((m=_createClass((function t(){_classCallCheck(this,t)}))).\u0275mod=l.Jb({type:m}),m.\u0275inj=l.Ib({factory:function(t){return new(t||m)},imports:[[o.c,r.e,_.a,i.Bb,y]]}),m)}}]);